<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <script src="vue.min.js"></script>
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Memory</title>
  <link href="//fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
  <style>
  * {
    padding: 0;
    margin: 0;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }
  :root {
    color: #e5e5e5;
    background-color: #131313;
    font-family: 'Press Start 2P', monospace, "Consolas";
    font-size: 100%;
  }
  html, body {
    height: 100%;
    width: 100%;
  }
  #app, body {
    display: flex;
    flex-direction: column;
  }
  p {
    margin: 1rem;
    font-size: 2.5rem;
  }
  .column {
    display: flex;
    flex-direction: column;
    min-height: 500px;
  }
  a.link {
    user-select: none;
    cursor: pointer;
    color: #e5e5e5;
    text-decoration: none;
    line-height: 2;
    position: relative;
    transition: all .25s ease;
    display: inline-flex;
  }
  a.link span {
    font-size: 12px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    padding: 0 2.5%;
  }
  a.link:before {
    content: '';
    display: block;
    position: absolute;
    top: 0; bottom: 0;
    left: 0; right: 0;
    background-color: transparent;
    transition: all .25s ease;
    z-index: -1;
  }
  a.link:hover {
    color: #ff4c75;
  }
  a.link:hover:before {
    background-color: #1e2a58;
  }
  .controls {
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
  }
  .prev, .next {
    user-select: none;
    cursor: pointer;
    padding: 25px 15px;
    color: #e5e5e5;
    transition: all .25s ease;
  }
  .prev.disabled, .next.disabled {
    opacity: .25;
  }
  .prev:hover, .next:hover {
    color: #9f0;
  }
  .btn {
    font-family: 'Press Start 2P', monospace, "Consolas";
    min-height: 35px;
    max-height: 35px;
    appearance: none;
    cursor: pointer;
    user-select: none;
    text-decoration: none;
    background-color: #131313;
    color: #9F0;
    border: 1px solid #9f0;
    padding: 0 15px;
    border-radius: 2px;
    font-size: 10px;
    transition: all .5s ease;
    outline: none;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  .btn:hover {
    color: rgba(153, 255, 0, 0.25);
    border-color: rgba(153, 255, 0, 0.25);
  }
  .btn.active {
    color: rgba(153, 255, 0, 0.25);
    border-color: rgba(153, 255, 0, 0.25);
  }
  .btn small {
    font-size: 50%;
    margin-top: 5px;
  }
  .filter {
    min-height: 35px;
    max-height: 35px;
    padding: 0 15px;
    border: 1px solid #9f0;
    border-radius: 2px;
    appearance: none;
    font-family: 'Press Start 2P', monospace, "Consolas";
    background-color: #131313;
    color: #9F0;
    outline: none;
  }
  .audio-list {
    padding: 25px 0 0 0;
    min-height: 500px;
    width: 100%;
    display: flex;
    flex-direction: column;
    position: relative;
  }
  nav {
    padding: 10px 0 0 0;
    font-size: 0;
    display: flex;
    flex-direction: row;
  }
  .nav__item {
    margin: 0 5px;
  }
  .empty {
    font-size: 24px;
    color: #e5e5e5;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    position: absolute;
  }
  </style>
</head>
<body>
  <section id="app">
    <nav>
      <button :class="calcClass('an')" @click="load('an')">
        <span>An</span>
        <small>13/04/17 2:15am</small>
      </button>
      <button :class="calcClass('vi')" @click="load('vi')">
        <span>Vi</span>
        <small>04/09/16 5:00am</small>
      </button>
      <button :class="calcClass('ar')" @click="load('ar')">
        <span>Ar</span>
        <small>13/04/17 11:29pm</small>
      </button>
      <button :class="calcClass('ma')" @click="load('ma')">
        <span>Ma</span>
        <small>13/04/17 11:39pm</small>
      </button>
      <button class="nav__item btn" @click="clear">clear</button>
    </nav>
    <section class="audio-list" v-if="page.length > 0">
      <div class="column">
        <a class="link" v-for="(item, index) in page" target="_blank" v-bind:href="hrefMake(item)">
          <span>{{ index + 1 + current }} - {{ item }}</span>
        </a>
      </div>
      <div class="controls">
        <span class="prev" @click="prevPage" :class="{ 'disabled': current === 0}"> ◀︎︎︎︎︎︎︎◀︎︎︎︎︎︎ </span>
        <span> {{ current / drop + 1 }} of {{ Math.ceil(audio.length / drop) }} </span>
        <span class="next" @click="nextPage"  :class="{ 'disabled': Math.ceil(current / drop + 1) === Math.ceil(audio.length / drop) }"> ▶︎▶︎ </span>
      </div>
    </section>
    <section v-else class="audio-list">
      <div class="empty">
        <span>Select data archive</span>
      </div>
    </section>
  </section>
  <script>
  const app5 = new Vue({
    el: '#app',
    data: {
      message: 'Coming Soon',
      audio: [],
      page: [],
      current: 0,
      drop: 20,
      name: '',
    },
    mounted() {},
    methods: {
      loadPage() {
        this.page = this.audio.slice(this.current, this.current + this.drop);
      },
      prevPage() {
        if (this.current !== 0) {
          this.current -= this.drop;
          this.loadPage();
        }
      },
      nextPage() {
        if (Math.ceil(this.current / this.drop + 1) !== Math.ceil(this.audio.length / this.drop)) {
          this.current += this.drop;
          this.loadPage();
        }
      },

      load(name) {
        this.audio = [];
        this.page = [];
        this.current = 0;
        this.name = name;

        setTimeout(() => {
          fetch(`/data/${name}.json`)
            .then(response => response.json())
            .then(body => body.audio)
            .then(audio => {
              this.audio = audio;
              this.loadPage();
            })
            .catch(err => console.error(err));
        }, 100);
      },
      hrefMake(item) {
        return `//vk.com/search?c%5Bper_page%5D=200&c%5Bq%5D=${item}&c%5Bsection%5D=audio`;
      },
      calcClass(name) {
        if (name === this.name) {
          return 'nav__item btn active';
        }
        return 'nav__item btn';
      },
      reverseMessage() {
        this.message = this.message.split('').reverse().join('')
      },
      clear() {
        this.audio = [];
        this.page = [];
        this.current = 0;
        this.name = '';
      },
    }
  })
  </script>
</body>
</html>
